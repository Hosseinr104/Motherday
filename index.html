<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ÛŒÚ© Ù…Ø¹Ù…Ø§ÛŒ Ø¯ÛŒÚ¯Ù‡.</title>
  <style>
    :root{
      --bg:#fff8ff;
      --card:#fff;
      --accent:#ff6fb5;
      --accent-2:#4c88e0;
      --muted:#6b6b6b;
      --text1:#1a1a1a;
      --text2:#ff3d7f;
      --text3:#5f5f5f;
      --text4:#6b3aff;
    }
    *{box-sizing:border-box}
    body{
      margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#ffe6f2 0%, #e6f7ff 100%);font-family: 'Tahoma', 'Vazirmatn', sans-serif;color:var(--text1);
    }
    .container{width:min(980px,95%);padding:18px;border-radius:16px;background:linear-gradient(180deg,rgba(255,255,255,0.95),rgba(255,255,255,0.8));box-shadow:0 10px 30px rgba(0,0,0,0.06)}
    header{display:block;text-align:center}
    h1{margin:0 0 8px 0;font-size:28px;color:var(--text2)}
    .subtitle{color:var(--text3);font-size:16px;margin-bottom:12px}

    .board{display:grid;grid-template-columns:repeat(8,1fr);gap:8px;padding:8px;background:linear-gradient(180deg,#ffffff,#fff7fb);border-radius:12px}
    .cell{aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;border-radius:10px;background:linear-gradient(180deg,#fff,#fff4f8);font-size:22px;font-weight:700;cursor:pointer;user-select:none;box-shadow:0 4px 10px rgba(0,0,0,0.06);transition:transform .08s ease, box-shadow .12s ease;color:var(--text4)}
    .cell:active{transform:translateY(2px)}
    .cell.selected{background:linear-gradient(90deg,#fff3c4,#fff7e0);}
    .cell.correct{background:linear-gradient(90deg,#c9ffca,#e6ffe8);}
    .cell.wrong{animation:shake .2s ease-in-out}
    @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-3px)}50%{transform:translateX(3px)}75%{transform:translateX(-2px)}}

    .info{padding:12px;border-radius:10px;background:linear-gradient(180deg,#fff,#f8fffd);box-shadow:inset 0 1px 0 rgba(255,255,255,0.6);margin-bottom:12px;color:var(--text3)}
    .hint{font-size:15px;margin:0}
    .controls{display:flex;gap:8px;justify-content:center;margin-top:10px}
    button{padding:10px 24px;border-radius:10px;border:0;background:var(--accent);color:white;font-weight:600;cursor:pointer;min-width:240px}
    button.secondary{background:var(--accent-2);color:white;letter-spacing:1px;font-weight:700}

    .celebration{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:none}
    .message{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.35);z-index:10}
    .message .box{background:linear-gradient(135deg,#fff,#ffe9ff);padding:34px 26px;border-radius:22px;box-shadow:0 30px 80px rgba(0,0,0,0.35);font-size:28px;font-weight:900;color:var(--text4);text-align:center;line-height:1.8;animation:pop 0.6s cubic-bezier(.2,1.4,.3,1)}
    @keyframes pop{0%{transform:scale(0.4) rotate(-8deg);opacity:0}70%{transform:scale(1.1) rotate(3deg)}100%{transform:scale(1) rotate(0)}}

    @media (max-width:520px){.container{padding:14px}h1{font-size:24px}.cell{font-size:18px}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ÛŒÚ© Ù…Ø¹Ù…Ø§ÛŒ Ø¯ÛŒÚ¯Ù‡.</h1>
      <div class="subtitle">ÙÙ‚Ø· ÛŒÚ© Ú©Ù„Ù…Ù‡Ù” Ù…Ø¹Ù†Ø§Ø¯Ø§Ø± Ø³Ù‡ Ø­Ø±ÙÛŒ Ø¯Ø§Ø®Ù„ Ø¬Ø¯ÙˆÙ„ Ù‡Ø³Øª.</div>
    </header>


    <div class="board" id="board" aria-label="Ø¬Ø¯ÙˆÙ„ Ø­Ø±ÙˆÙ"></div>

    <div class="controls">
      <button id="resetBtn" class="secondary">Ø¯Ø±Ù‡Ù… Ú©Ø±Ø¯Ù†</button>
    </div>

  </div>

  <div class="message" id="message">
    <div class="box">ğŸ¦‰<br><strong>Ø¢Ø¢Ø¢Ø¢Ø¢ÙØ±ÛŒÛŒÛŒÛŒÙ†!!!</strong><br><br>Ø­Ø§Ù„Ø§ Ø¨Ø±Ø§ÛŒ Ø§Ø¯Ø§Ù…Ù‡ Ú©Ø§Ø± ÙÙ‚Ø· Ú©Ø§ÙÛŒÙ‡<br>Ø¨Ù‡ Ø¬ØºØ¯ Ø¯Ø§Ù†Ø§ Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ú©Ù†ÛŒ.<br>Ø§ÙˆÙ† Ù…Ø±Ø­Ù„Ù‡ Ø¢Ø®Ø±Ùˆ Ù…ÛŒâ€ŒØ¯ÙˆÙ†Ù‡.</div>
  </div>
  <div class="celebration" id="celebration"></div>

  <script>
    const secretWord = ['Ø¬','Øº','Ø¯'];
    const rows = 10;
    const cols = 6;
    let secret;

    const pool = ['Ø¨','Ù¾','Øª','Ø«','Ø³','Ø´','Øµ','Ø¶','Ø·','Ø¸','Ø¹','Ú©','Ú¯','Ù„','Ù…','Ù†','Ùˆ','Ù‡','ÛŒ','Ú†','Ú˜'];

    const boardEl = document.getElementById('board');
    const messageEl = document.getElementById('message');
    const celebrationEl = document.getElementById('celebration');

    let cells = [];
    let selected = [];

    function makeGrid(){
      boardEl.innerHTML='';
      cells=[];
      boardEl.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
      const gridLetters = Array.from({length: rows}, ()=>Array(cols).fill(null));

      // Ù…Ú©Ø§Ù† Ø¬Ø¯ÛŒØ¯ Ùˆ ØªØµØ§Ø¯ÙÛŒ Ø¨Ø±Ø§ÛŒ Ú©Ù„Ù…Ù‡ Ø±Ù…Ø²
      const startRow = Math.floor(Math.random()*(rows-(Math.random()<0.5?3:0)));
      const startCol = Math.floor(Math.random()*(cols-(Math.random()<0.5?3:0)));
      secret = {row:startRow, col:startCol, dir:Math.random()<0.5?'v':'h'};

      function safePick(r,c){
        let tries=0;
        while(true){
          const l = pool[Math.floor(Math.random()*pool.length)];
          const neighbors = [[r-1,c],[r+1,c],[r,c-1],[r,c+1],[r-1,c-1],[r-1,c+1],[r+1,c-1],[r+1,c+1]];
          const clash = neighbors.some(([nr,nc])=>nr>=0 && nr<rows && nc>=0 && nc<cols && gridLetters[nr][nc]===l);
          if(!clash || tries>20) return l;
          tries++;
        }
      }

      for(let r=0;r<rows;r++){
        for(let c=0;c<cols;c++){
          const div=document.createElement('div');
          div.className='cell';
          const pos=`${r}-${c}`;
          div.dataset.pos=pos;

          const letter = safePick(r,c);
          gridLetters[r][c]=letter;
          div.dataset.letter=letter;
          div.textContent=letter;
          boardEl.appendChild(div);
          cells.push(div);
          div.addEventListener('click',()=>onCellClick(div));
        }
      }

      for(let i=0;i<3;i++){
        const r = secret.row + (secret.dir==='v'?i:0);
        const c = secret.col + (secret.dir==='h'?i:0);
        const idx = r*cols + c;
        const cell = cells[idx];
        cell.dataset.letter = secretWord[i];
        cell.textContent = secretWord[i];
      }
    }

    function onCellClick(cell){
      if(cell.classList.contains('correct')) return;
      if(selected.includes(cell)) return;
      cell.classList.add('selected');
      selected.push(cell);
      if(selected.length===3) checkAnswer();
    }

    function checkAnswer(){
      const coords=selected.map(d=>d.dataset.pos.split('-').map(Number));
      const expected=[];
      for(let i=0;i<3;i++){
        const r=secret.row + (secret.dir==='v'?i:0);
        const c=secret.col + (secret.dir==='h'?i:0);
        expected.push([r,c]);
      }
      const match=coords.every((xy,i)=>xy[0]===expected[i][0] && xy[1]===expected[i][1]);
      if(match){
        selected.forEach(s=>{s.classList.remove('selected'); s.classList.add('correct');});
        celebrate();
      } else {
        selected.forEach(s=>s.classList.add('wrong'));
        setTimeout(()=>{
          selected.forEach(s=>{s.classList.remove('selected','wrong');});
          selected=[];
        },300);
      }
    }

    function celebrate(){
      messageEl.style.display='flex';
      megaConfetti();
      screenBoom();
      document.querySelector('.container').style.pointerEvents='none';
    }

    function megaConfetti(){
      const colors=['#ff6fb5','#ffd166','#6ee7b7','#9ad0ff','#ffb4a2','#c77dff'];
      const amount=300;
      for(let i=0;i<amount;i++){
        const c=document.createElement('div');
        c.style.position='absolute';
        c.style.width=(6+Math.random()*12)+'px';
        c.style.height=(6+Math.random()*14)+'px';
        c.style.background=colors[Math.floor(Math.random()*colors.length)];
        c.style.left=Math.random()*100+'%';
        c.style.top='-10%';
        c.style.opacity='1';
        c.style.borderRadius=Math.random()>0.5?'50%':'3px';
        c.style.pointerEvents='none';
        celebrationEl.appendChild(c);
        const dur=1000+Math.random()*1200;
        c.animate([
          {transform:`translateY(0) rotate(0deg)`},
          {transform:`translateY(${window.innerHeight+200}px) rotate(${Math.random()*1080-540}deg)`}
        ],{duration:dur,easing:'cubic-bezier(.1,.8,.2,1)'});
        setTimeout(()=>c.remove(),dur);
      }
    }

    function screenBoom(){
      document.body.animate([
        {transform:'scale(1)'},
        {transform:'scale(1.015)'},
        {transform:'scale(1)'}
      ],{duration:400,easing:'ease-out'});
    }

    document.getElementById('resetBtn').addEventListener('click',()=>{
      selected=[];
      document.querySelector('.container').style.pointerEvents='auto';
      messageEl.style.display='none';
      celebrationEl.innerHTML='';
      cells.forEach(s=>{if(s){s.classList.remove('selected','correct','wrong');}});
      makeGrid();
    });

    makeGrid();
  </script>
</body>
</html>
